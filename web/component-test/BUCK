java_library(
    name = "queue-triage-web-component-test",
    srcs = glob(['src/main/java/**/*.java']),
    deps = [
        '//common/id:queue-triage-common-id',
        '//common/jgiven:jgiven',
        '//common/ldap-test-support:queue-triage-ldap-test-support',
        '//core/client:queue-triage-core-client',
        '//core/client-test-support:queue-triage-core-client-test-support',
        '//lib/selenide:selenide',
        '//lib/selenium:selenium-api',
        '//lib/spring:spring-boot-test',
        '//lib/spring:spring-boot-with-dependencies',
        '//lib/spring:spring-test',
        '//lib/spring:spring-web',
        '//lib/test:hamcrest-core',
        '//lib/test:hamcrest-library',
        '//lib/test:jgiven',
        '//lib/test:jgiven-spring',
        '//lib/test:mockito-core',
    ],
    visibility = [
        "//web/component-test:test"
    ]
)

java_test(
    name = "test",
    srcs = glob(['src/test/java/**/*Test.java']),
    deps = [
        '//common/jgiven:jgiven',
        '//core/client-test-support:queue-triage-core-client-test-support',
        "//lib/hibernate-validator:hibernate-validator",
        '//lib/selenide:selenide',
        '//lib/selenide:selenide-dependencies',
        '//lib/selenium/firefox-driver:selenium-firefox-driver-with-dependencies',
#         '//lib/selenium/htmlunit-driver:htmlunit-driver-with-dependencies',
#         '//lib/selenium/phantomjs-driver:phantomjs-driver-with-dependencies',
        '//lib/spring:spring-beans',
        '//lib/spring:spring-boot-test',
        '//lib/spring:spring-context',
        '//lib/spring:spring-test',
        '//lib/test:common',
        '//lib/test:jgiven',
        '//lib/test:jgiven-spring',
        '//web/component-test:queue-triage-web-component-test',
        '//web/server:queue-triage-web-server',
    ],
    vm_args = [
        "-Dbrowser=firefox",
        "-Dwebdriver.gecko.driver=lib/geckodriver/geckodriver",
#         "-Dbrowser=htmlunit",
#         "-Dbrowser=phantomjs",
        "-Djgiven.report.dir=buck-out/gen/web/component-test/jgiven-reports",
    ]
)

# buck build //web/component-test:generate-jgiven-html-reports
genrule(
    name = "generate-jgiven-html-reports",
    cmd  = "$(exe //lib/test:jgiven-html5-report-with-deps) --format=html --sourceDir=`pwd`/../jgiven-reports --targetDir=$OUT",
    out  = "jgiven-html-reports",
)
